<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Secure Code Analyzer Report</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #fafafa; }
    h1 { color: #333; }
    .meta { margin-bottom: 20px; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ddd; padding: 8px; font-size: 14px; }
    th { background: #f2f2f2; }
    tr:hover { background: #f1f1f1; }
    select { margin: 10px 0; padding: 5px; }
  </style>
  <script>
    function filterSeverity() {
        var filter = document.getElementById("sevFilter").value;
        var rows = document.querySelectorAll("tbody tr");
        rows.forEach(row => {
            if (filter === "All" || row.dataset.severity === filter) {
                row.style.display = "";
            } else {
                row.style.display = "none";
            }
        });
    }
  </script>
</head>
<body>
  <h1>Secure Code Analyzer Report</h1>
  <div class="meta">
    <strong>Report generated on:</strong> Aug 29, 2025, 04:34 UTC<br>
    <strong>Totals:</strong> 
    Critical: 0 | 
    High: 8 | 
    Medium: 2 | 
    Low: 1
  </div>

  <label for="sevFilter"><b>Filter by Severity:</b></label>
  <select id="sevFilter" onchange="filterSeverity()">
    <option>All</option>
    <option>CRITICAL</option>
    <option>HIGH</option>
    <option>MEDIUM</option>
    <option>LOW</option>
  </select>

  <table>
    <thead>
      <tr>
        <th>Severity</th>
        <th>Category</th>
        <th>Rule</th>
        <th>File</th>
        <th>Line</th>
        <th>Message</th>
        <th>Snippet</th>
        <th>Suggestion</th>
        <th>Detected By</th>
      </tr>
    </thead>
    <tbody>

      <tr data-severity="HIGH" style="background:#f5c6cb">
        <td>HIGH</td>
        <td>Command Execution</td>
        <td>CMD_INJECTION</td>
        <td>samples/js/app.js</td>
        <td>12</td>
        <td>Possible Command Injection via child_process.exec()</td>
        <td><code>child_process.exec('ls ' + req.query.dir); // command injection</code></td>
        <td>Use safer spawn with arg arrays; validate/whitelist inputs.</td>
        <td>Regex</td>
      </tr>

      <tr data-severity="HIGH" style="background:#f5c6cb">
        <td>HIGH</td>
        <td>Dangerous Function</td>
        <td>CODE_INJECTION</td>
        <td>samples/js/app.js</td>
        <td>17</td>
        <td>Possible Code Injection via eval()</td>
        <td><code>eval(req.query.code); // code injection</code></td>
        <td>Avoid eval(); use JSON.parse or predefined function maps.</td>
        <td>Regex</td>
      </tr>

      <tr data-severity="HIGH" style="background:#f5c6cb">
        <td>HIGH</td>
        <td>SQL Injection</td>
        <td>SQLI</td>
        <td>samples/js/app.js</td>
        <td>22</td>
        <td>Possible SQL Injection: query built with string concatenation.</td>
        <td><code>const sql = "SELECT * FROM users WHERE name = '" + req.query.name + "'"; // SQLi</code></td>
        <td>Use parameterized queries or ORM to avoid injection.</td>
        <td>Regex</td>
      </tr>

      <tr data-severity="HIGH" style="background:#f5c6cb">
        <td>HIGH</td>
        <td>Cross-Site Scripting</td>
        <td>XSS</td>
        <td>samples/js/app.js</td>
        <td>28</td>
        <td>Possible DOM-based XSS via innerHTML assignment.</td>
        <td><code>document.body.innerHTML = req.query.html; // XSS in client-side route (demo)</code></td>
        <td>Use textContent instead of innerHTML; sanitize/encode inputs.</td>
        <td>Regex</td>
      </tr>

      <tr data-severity="MEDIUM" style="background:#fff3cd">
        <td>MEDIUM</td>
        <td>Weak Cryptography</td>
        <td>MD5</td>
        <td>samples/js/app.js</td>
        <td>7</td>
        <td>Use of weak hash algorithm MD5</td>
        <td><code>const h = crypto.createHash('md5').update(req.query.q || 'x').digest('hex');</code></td>
        <td>Use stronger algorithms (SHA-256, bcrypt, Argon2).</td>
        <td>Regex</td>
      </tr>

      <tr data-severity="HIGH" style="background:#f5c6cb">
        <td>HIGH</td>
        <td>Dangerous Function</td>
        <td>JS-EVAL-001</td>
        <td>samples/js/app.js</td>
        <td>17</td>
        <td>Use of eval() can lead to code injection.</td>
        <td><code>eval(...)</code></td>
        <td>Avoid eval(); use JSON.parse or predefined maps.</td>
        <td>AST</td>
      </tr>

      <tr data-severity="HIGH" style="background:#f5c6cb">
        <td>HIGH</td>
        <td>Cross-Site Scripting</td>
        <td>PHP_XSS</td>
        <td>samples/php/index.php</td>
        <td>8</td>
        <td>Possible XSS in PHP by echoing untrusted input</td>
        <td><code>echo $_GET['html']; // XSS</code></td>
        <td>Escape output using htmlspecialchars; validate inputs.</td>
        <td>Regex</td>
      </tr>

      <tr data-severity="HIGH" style="background:#f5c6cb">
        <td>HIGH</td>
        <td>Command Execution</td>
        <td>PHP_CMD</td>
        <td>samples/php/index.php</td>
        <td>13</td>
        <td>Possible Command Injection in PHP via system/exec call.</td>
        <td><code>system("ls " . $_GET['cmd']); // command injection</code></td>
        <td>Avoid system/exec calls; use PHP built-in APIs with strict validation.</td>
        <td>Regex</td>
      </tr>

      <tr data-severity="MEDIUM" style="background:#fff3cd">
        <td>MEDIUM</td>
        <td>Weak Cryptography</td>
        <td>PHP_MD5</td>
        <td>samples/php/index.php</td>
        <td>10</td>
        <td>Use of weak hash algorithm MD5 in PHP.</td>
        <td><code>$hash = md5($_GET['p']); // weak crypto</code></td>
        <td>Use password_hash() with bcrypt/Argon2 instead of MD5.</td>
        <td>Regex</td>
      </tr>

      <tr data-severity="LOW" style="background:#d1ecf1">
        <td>LOW</td>
        <td>Error Handling</td>
        <td>PHP_ERROR</td>
        <td>samples/php/index.php</td>
        <td>19</td>
        <td>Error information leakage in PHP via debug functions.</td>
        <td><code>var_dump($e); // error leak</code></td>
        <td>Do not expose raw errors; log errors server-side and show generic messages.</td>
        <td>Regex</td>
      </tr>

      <tr data-severity="HIGH" style="background:#f5c6cb">
        <td>HIGH</td>
        <td>Command Execution</td>
        <td>PHP-SYSTEM-001</td>
        <td>samples/php/index.php</td>
        <td>13</td>
        <td>Possible Command Injection in PHP via system().</td>
        <td><code>system(...)</code></td>
        <td>Avoid system/exec calls; use PHP built-in APIs with strict input validation.</td>
        <td>AST</td>
      </tr>

    </tbody>
  </table>
</body>
</html>
