[
  {
    "id": "PHP-SYSTEM-EXEC-001",
    "file": "uploads\\samp1.php",
    "line": 34,
    "severity": "HIGH",
    "category": "Command Execution",
    "message": "Command execution can lead to injection if args are tainted.",
    "suggestion": "Avoid shell execution; use built-in APIs and strict validation.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "echo \"<pre>\";",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-ERROR-LEAK-001",
    "file": "uploads\\samp1.php",
    "line": 9,
    "severity": "LOW",
    "category": "Error Handling",
    "message": "Leaking raw errors or phpinfo() reveals sensitive info.",
    "suggestion": "Log errors server-side and show generic error messages.",
    "owasp": "A09:2021-SecurityLoggingandMonitoringFailures,A10:2021-Logging&MonitoringFailures",
    "cwe": "",
    "snippet": "die(\"DB Connection Failed: \" . mysqli_connect_error());",
    "detected_by": "Heuristic"
  },
  {
    "id": "PHP-MYSQLI-001",
    "file": "uploads\\samp1.php",
    "line": 20,
    "severity": "HIGH",
    "category": "Sql Injection",
    "message": "Use of mysqli_query with untrusted input may lead to SQL Injection.",
    "suggestion": "Always use prepared statements (mysqli_stmt or PDO).",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "$result = mysqli_query($conn, $sql);",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-INCLUDE-001",
    "file": "uploads\\samp1.php",
    "line": 43,
    "severity": "HIGH",
    "category": "File Inclusion",
    "message": "Dynamic include/require detected. May allow LFI/RFI.",
    "suggestion": "Never include user input in include/require paths. Use whitelists.",
    "owasp": "A05:2021-SecurityMisconfiguration",
    "cwe": "",
    "snippet": "$page = $_GET['page'];",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-INCLUDE-001",
    "file": "uploads\\samp1.php",
    "line": 112,
    "severity": "HIGH",
    "category": "File Inclusion",
    "message": "Dynamic include/require detected. May allow LFI/RFI.",
    "suggestion": "Never include user input in include/require paths. Use whitelists.",
    "owasp": "A05:2021-SecurityMisconfiguration",
    "cwe": "",
    "snippet": "<h2>Page Include (LFI/RFI)</h2>",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-UPLOAD-001",
    "file": "uploads\\samp1.php",
    "line": 55,
    "severity": "HIGH",
    "category": "Insecure File Upload",
    "message": "File upload without validation detected.",
    "suggestion": "Validate file type, size, extension; randomize name; store outside web root.",
    "owasp": "A05:2021-SecurityMisconfiguration",
    "cwe": "",
    "snippet": "move_uploaded_file($tmp, $filename);",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-HEUR-023",
    "file": "uploads\\samp1.php",
    "line": 72,
    "severity": "LOW",
    "category": "Session Handling",
    "message": "Session start detected, ensure secure flags are set.",
    "suggestion": "Use secure session cookies (HttpOnly, Secure, SameSite).",
    "owasp": "A07:2021-IdentificationandAuthenticationFailures",
    "cwe": "",
    "snippet": "session_start();",
    "detected_by": "Heuristic"
  },
  {
    "id": "PHP-SYSTEM-AST-001",
    "file": "uploads\\samp1.php",
    "line": 35,
    "severity": "HIGH",
    "category": "Command Execution",
    "message": "system() detected in PHP AST; may allow command injection.",
    "suggestion": "Avoid system(); use safer built-in APIs.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "system(\"ping -c 2 \" . $host); // vulnerable",
    "detected_by": "AST"
  },
  {
    "id": "PHP-INCLUDE-AST-001",
    "file": "uploads\\samp1.php",
    "line": 44,
    "severity": "HIGH",
    "category": "File Inclusion",
    "message": "Dynamic include/require detected.",
    "suggestion": "Never use user input in include/require paths. Use whitelists.",
    "owasp": "A05:2021-SecurityMisconfiguration",
    "cwe": "",
    "snippet": "include($page . \".php\"); // vulnerable",
    "detected_by": "AST"
  }
]